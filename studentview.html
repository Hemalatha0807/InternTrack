<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Internship Details</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            text-align: center;
            padding: 20px;
        }
        h2 {
            color: #333;
        }
        input {
            padding: 10px;
            font-size: 16px;
            margin: 10px;
            width: 200px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover {
            background: #45a049;
        }
        #message {
            color: red;
            font-weight: bold;
        }
        .container {
            display: none;
            width: 80%;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .row {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        .row:last-child {
            border-bottom: none;
        }
        .label {
            font-weight: bold;
            width: 45%;
            text-align: left;
        }
        .value {
            width: 50%;
            text-align: left;
        }
    </style>
</head>
<body>
    <h2>View Internship Details</h2>
    <input type="text" id="registerNumber" placeholder="Enter Register Number">
    <button onclick="fetchInternshipDetails()">Search</button>
    <p id="message"></p>
    <div class="container" id="detailsContainer"></div>

    <script>
        function fetchInternshipDetails() {
            let regNumber = document.getElementById("registerNumber").value.trim();
            if (!regNumber) {
                document.getElementById("message").innerText = "Please enter a Register Number!";
                return;
            }

            fetch("https://script.google.com/macros/s/AKfycbyvC6wnMgHdPFQ2UkWuZlmAr2uRLF3yRVu87eY7_Kp7sY7ObKAHvEQ_6v2q66ixDy3_SQ/exec?register=" + regNumber)
                .then(response => response.json())
                .then(data => {
                    let container = document.getElementById("detailsContainer");
                    let message = document.getElementById("message");
                    container.innerHTML = "";

                    if (data.length === 0) {
                        message.innerText = "No details found for this Register Number.";
                        container.style.display = "none";
                        return;
                    }

                    message.innerText = "";
                    container.style.display = "block";

                    let fields = ["Register Number", "Student Name", "Title", "Mobile", "Section", "Year", "Obtained Internship", "Period", "Start Date", "End Date", "Company", "Placement Source", "Stipend", "Internship Type", "Location", "Permission Letter", "Completion Certificate", "Internship Report", "Student Feedback", "Employee Feedback"];
                    
                    data[0].forEach((value, index) => {
                        let row = document.createElement("div");
                        row.className = "row";
                        row.innerHTML = `<div class="label">${fields[index]}</div><div class="value">${value}</div>`;
                        container.appendChild(row);
                    });
                })
                .catch(error => console.error("Error fetching data:", error));
        }
    </script>
</body>
</html>
